# -*- coding: utf-8 -*-
"""smap email prediction.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1qwU10zwRurZaJ2JgakdR-k9i-5U2f0WN
"""

from google.colab import files
files.upload()

import pandas as pd
import numpy as np
import seaborn as sns

df=pd.read_csv('emails.csv')

df

x=df.iloc[:,:2]

x

x.shape

x['spam'].value_counts()

x.drop_duplicates(inplace=True)

x

x.isnull().sum()

x[x['spam'].isnull()]

new=x.dropna(how='any')

new

new.isnull().sum()

x=new.text.values

y=new.spam.values

from sklearn.model_selection import train_test_split

xtrain, xtest, ytrain, ytest=train_test_split(x,y, test_size=0.2)

from sklearn.feature_extraction.text import CountVectorizer

cv= CountVectorizer()

x_train=cv.fit_transform(xtrain)

x_train.toarray()

from sklearn.naive_bayes import MultinomialNB

model=MultinomialNB()

model.fit(x_train,ytrain)

x_test=cv.transform(xtest)

x_test.toarray()

model.score(x_test, ytest)

emails=['i am looking for a python and machine learning tutrial', 'hey you win an iphone x giveaway for free please do the servey']

cv_emails=cv.transform(emails)

model.predict(cv_emails)

pred=model.predict(x_test)

pred

from sklearn.metrics import accuracy_score

accuracy_score(ytest, pred)

from sklearn.metrics import confusion_matrix

confusion_matrix(ytest,pred)

from sklearn.metrics import classification_report

print(classification_report(ytest,pred))

